parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"UL96":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});
},{}],"7QCb":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var o in r)"default"!==o&&Object.prototype.hasOwnProperty.call(r,o)&&e(n,r,o);return t(n,r),n},n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,u){function a(e){try{s(n.next(e))}catch(t){u(t)}}function i(e){try{s(n.throw(e))}catch(t){u(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,i)}s((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(u){return function(i){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(i){u=[6,i],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,i])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Schema=exports.$boolean=exports.$number=exports.$object=exports.$string=exports.$array=exports.$unknown=exports.unknown=exports.object=exports.array=exports.boolean=exports.number=exports.string=exports.default=void 0;var u=r(require("computed-types"));exports.Schema=u.default,Object.defineProperty(exports,"$array",{enumerable:!0,get:function(){return u.array}}),Object.defineProperty(exports,"$boolean",{enumerable:!0,get:function(){return u.boolean}}),Object.defineProperty(exports,"$number",{enumerable:!0,get:function(){return u.number}}),Object.defineProperty(exports,"$object",{enumerable:!0,get:function(){return u.object}}),Object.defineProperty(exports,"$string",{enumerable:!0,get:function(){return u.string}}),Object.defineProperty(exports,"$unknown",{enumerable:!0,get:function(){return u.unknown}});var a=require("./types"),i=u.default({query:u.object.optional(),update:u.object.optional(),$:u.object.optional({})}).destruct(),s=function(){function e(e,t,r){this.resolvers=e,this.types=t,this.options=null!=r?r:{}}return e.prototype.evalArgs=function(e,t){var r=this;if("string"==typeof e){var n=/\$([_a-zA-Z][_a-zA-Z0-9]{0,30})/g.exec(e);n&&(e=e==n[0]?t[n[1]]:e.replace(n[0],t[n[1]]))}else"object"==typeof e&&"length"in e?e=e.map(function(e){return r.evalArgs(e,t)}):"object"!=typeof e||"length"in e||Object.keys(e).forEach(function(n){e[n]=r.evalArgs(e[n],t)});return e},e.prototype.processQuery=function(e,t){return n(this,void 0,void 0,function(){var r=this;return o(this,function(a){return[2,new Promise(function(a,i){return n(r,void 0,void 0,function(){var r,n,s,c,l,p,f,b,y,d,h,v,g,x,m;return o(this,function(o){switch(o.label){case 0:for(f in r=this,n=e.query,s=e.$,c="query",l={},("object"!=typeof n||"length"in n)&&i({error:!0,at:c,message:"query should be an object"}),Object.keys(n).length||i({error:!0,at:c,message:"query can't be empty"}),p=[],n)p.push(f);b=0,o.label=1;case 1:if(!(b<p.length))return[3,6];y=p[b],c=y,y in r.types||i({error:!0,at:c,message:y+" is not defined in types"}),y in r.resolvers.query||i({error:!0,at:c,message:y+" is not defined in types"}),o.label=2;case 2:return o.trys.push([2,4,,5]),d=u.default(r.types[y],{strict:!0}).destruct(),h=r.evalArgs(n[y],s),[4,r.resolvers.query[y](h,t)];case 3:return v=o.sent(),g=d(v),x=g[0],g[1],x&&i({error:!0,at:c,message:x}),l[y]=v,[3,5];case 4:return m=o.sent(),i({error:!0,at:c,message:m}),[3,5];case 5:return b++,[3,1];case 6:return a(l),[2]}})})})]})})},e.prototype.process=function(e,t){return n(this,void 0,void 0,function(){var r=this;return o(this,function(u){return[2,new Promise(function(u,a){return n(r,void 0,void 0,function(){var r,n,s,c,l,p;return o(this,function(o){switch(o.label){case 0:return r=i(e),n=r[0],s=r[1],c={},"root",n&&a({error:!0,at:"root",message:n}),(null==s?void 0:s.query)||(null==s?void 0:s.update)||a({error:!0,at:"root",message:"query should contain at least one query or update"}),(null==s?void 0:s.query)?(l=c,p="data",[4,this.processQuery({query:s.query,$:s.$},t).catch(function(e){return a(e)})]):[3,2];case 1:l[p]=o.sent(),o.label=2;case 2:return u(c),[2]}})})})]})})},e}();exports.default=s;var c=u.string.optional(),l=u.number.optional(),p=u.boolean.optional(),f=u.array.optional(),b=u.object.optional(),y=u.unknown.optional();exports.string=c,exports.number=l,exports.boolean=p,exports.array=f,exports.object=b,exports.unknown=y;
},{"./types":"UL96"}]},{},["7QCb"], null)
//# sourceMappingURL=/index.js.map